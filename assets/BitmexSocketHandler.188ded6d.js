import{G as o,S as r}from"./SocketHandlers.b14aa602.js";class a extends o{constructor(e){super(e),this.updateParent=e,this.socket=new WebSocket("wss://ws.bitmex.com/realtime"),this.socket.onopen=s=>{console.debug(`Socket with ${this.provider} opened`,s)},this.socket.onmessage=s=>{console.debug(`message from ${this.provider}`,s);const t=JSON.parse(s.data);this.isRelevant(t)&&this.updateBestPrice(t)}}provider=r.BITMEX;subscribe(e){const s=JSON.stringify({op:"subscribe",args:[`orderBook10:${e.replaceAll("BTC","XBT")}`]});console.debug(`Subscribing to ${e} on ${this.provider}`),this.socket.send(s)}unsubscribe(e){const s=JSON.stringify({op:"unsubscribe",args:[`orderBook10:${e.replaceAll("BTC","XBT")}`]});console.debug(`Subscribing to ${e}@bookTicker on ${this.provider}`),this.socket.send(s)}isRelevant(e){return e.table==="orderBook10"&&e.data[0]?.bids?.length>0&&e.data[0]?.asks?.length>0}isUpdateDue(e){return!0}updateBestPrice(e){this.bestPrice={symbol:e.data[0].symbol.replaceAll("XBT","BTC"),provider:this.provider,bid:e.data[0].bids[0][0],ask:e.data[0].asks[0][0]}}}export{a as default};
