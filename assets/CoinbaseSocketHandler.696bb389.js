import{G as i}from"./GenericSocketHandler.bd674351.js";import r from"./SocketHandlers.0ffd5406.js";import"./global.dae64e40.js";class p extends i{constructor(e){super(e),this.updateParent=e,this.socket=new WebSocket("wss://ws-feed.exchange.coinbase.com"),this.socket.onopen=s=>{console.debug(`Socket with ${this.provider} opened`,s)},this.socket.onmessage=s=>{console.debug(`message from ${this.provider}`,s);const t=JSON.parse(s.data);this.isRelevant(t)&&this.updateBestPrice(t)}}provider=r.COINBASE;subscribe(e){const s=`${e.slice(0,3)}-${e.slice(3)}`,t=JSON.stringify({type:"subscribe",product_ids:[s],channels:["ticker"]});console.debug(`Subscribing to ${e} level2 on ${this.provider}`),this.socket.send(t)}unsubscribe(e){const s=`${e.slice(0,3)}-${e.slice(3)}`,t=JSON.stringify({type:"unsubscribe",product_ids:[s],channels:["ticker"]});console.debug(`Unsubscribing from ${e} level2 on ${this.provider}`),this.socket.send(t)}isRelevant(e){return e.type==="ticker"}isUpdateDue(e){return!0}updateBestPrice(e){this.bestPrice={symbol:e.product_id.replaceAll("-",""),provider:this.provider,bid:e.best_bid,ask:e.best_ask}}}export{p as default};
